<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Razer Viper Ultimate - 888Lots Redesign</title>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#2563eb;--primary-hover:#1d4ed8;
      --success:#16a34a;--success-bg:#dcfce7;
      --danger:#dc2626;--danger-bg:#fee2e2;
      --surface:#fff;--background:#f8fafc;--border:#e2e8f0;
      --text-main:#0f172a;--text-secondary:#64748b;--text-muted:#94a3b8;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;background:var(--background);color:var(--text-main);font-size:14px;line-height:1.5;padding-bottom:40px}
    .container{max-width:1440px;margin:0 auto;padding:20px}

    /* Breadcrumbs */
    .breadcrumbs{font-size:12px;color:var(--text-secondary);margin-bottom:10px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .breadcrumbs a{color:var(--text-secondary);text-decoration:none;transition:color .2s}
    .breadcrumbs a:hover{color:var(--primary)}

    /* Hashtag pills row */
    .hashtag-row{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0 16px}
    .hashtag{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:999px;background:#eef2ff;color:#3730a3;font-weight:600;font-size:12px;border:1px solid #c7d2fe;text-decoration:none;transition:transform .06s ease,background .2s ease}
    .hashtag:hover{background:#dbe3ff;transform:translateY(-1px)}
    .hashtag i{font-size:14px;opacity:.85}
    .hashtag-muted{background:#f1f5f9;border-color:#e2e8f0;color:#475569}

    /* Header */
    .product-header{background:var(--surface);padding:24px;border-radius:8px;border:1px solid var(--border);margin-bottom:20px;box-shadow:0 1px 2px rgba(0,0,0,.05)}
    .product-title{font-size:22px;font-weight:800;margin-bottom:10px;line-height:1.25}
    .header-meta{display:flex;flex-wrap:wrap;gap:16px;align-items:center;border-top:1px solid var(--border);padding-top:16px}
    .hashtags{display:flex;gap:8px}
    .tag{background:#eff6ff;color:var(--primary);font-size:12px;font-weight:600;padding:4px 10px;border-radius:999px;text-decoration:none;transition:.2s}
    .tag:hover{background:var(--primary);color:#fff}
    .id-chips{display:flex;gap:8px;flex-wrap:wrap}
    .id-chip{font-family:monospace;font-size:11px;background:var(--background);padding:6px 10px;border-radius:4px;cursor:pointer;display:flex;align-items:center;gap:6px;color:var(--text-secondary);border:1px solid var(--border);transition:.2s;user-select:none}
    .id-chip:hover{border-color:var(--primary);color:var(--primary);background:#fff}
    .status-badges{display:flex;gap:8px;margin-left:auto}
    .badge{font-size:11px;font-weight:800;padding:4px 8px;border-radius:4px;text-transform:uppercase}
    .badge.fba{background:var(--success-bg);color:var(--success)}
    .badge.promo{background:var(--danger-bg);color:var(--danger)}

    /* Main grid (equal height columns) */
    .product-grid{display:grid;grid-template-columns:380px 1fr 340px;gap:20px;margin-bottom:24px;align-items:stretch}
    .gallery-card,.data-column,.buy-box{display:flex;flex-direction:column;height:100%}

    /* Gallery */
    .gallery-card{background:var(--surface);border-radius:8px;border:1px solid var(--border);padding:20px}
    .main-image-container{width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;margin-bottom:16px;background:#fff;overflow:hidden;border-radius:6px;border:1px solid var(--border)}
    .main-image{max-width:100%;max-height:100%;object-fit:contain}
    .thumbnails{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:auto}
    .thumb{aspect-ratio:1/1;border:1px solid var(--border);border-radius:4px;padding:4px;cursor:pointer;transition:.2s;background:#fff;display:flex;align-items:center;justify-content:center}
    .thumb.active,.thumb:hover{border-color:var(--primary);box-shadow:0 0 0 2px rgba(37,99,235,.1)}
    .thumb img{width:100%;height:100%;object-fit:contain}

    /* Middle column cards */
    .data-stack{display:flex;flex-direction:column;gap:20px;flex:1;min-height:100%}
    .info-card{background:var(--surface);border-radius:8px;border:1px solid var(--border);overflow:hidden;display:flex;flex-direction:column;min-height:0;flex:1}
    .info-header{background:var(--background);padding:12px 20px;font-size:12px;font-weight:800;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
    .profit-section{padding:24px;background:var(--success-bg);flex:1}
    .profit-row{display:flex;justify-content:space-between;margin-bottom:12px;font-size:14px;color:var(--text-secondary)}
    .profit-row strong{color:var(--text-main)}
    .profit-row.final{margin-top:16px;padding-top:16px;border-top:1px solid rgba(0,0,0,.05);margin-bottom:0;align-items:center}
    .profit-value-large{font-size:26px;font-weight:800;color:var(--success);line-height:1}
    .roi-pill{background:var(--success);color:#fff;font-size:13px;font-weight:700;padding:4px 8px;border-radius:4px;margin-left:8px}

    .market-grid{display:grid;grid-template-columns:1fr 1fr;padding:20px;gap:24px}
    .data-point{display:flex;flex-direction:column;gap:4px}
    .data-label{font-size:11px;text-transform:uppercase;color:var(--text-secondary);font-weight:700}
    .data-value{font-size:20px;font-weight:800}
    .data-muted{color:var(--text-muted);font-weight:700}
    .micro-note{padding:0 20px 20px;color:var(--text-muted);font-size:12px;line-height:1.4}

    .tools-bar{display:grid;grid-template-columns:repeat(4,1fr);border-top:1px solid var(--border);margin-top:auto}
    .tool-btn{padding:14px;background:#fff;border:none;border-right:1px solid var(--border);color:var(--text-secondary);font-weight:700;font-size:12px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:6px;text-decoration:none;transition:.2s}
    .tool-btn:last-child{border-right:none}
    .tool-btn:hover{background:var(--background);color:var(--primary)}
    .tool-btn i{font-size:18px}

    /* Buy box */
    .buy-box{background:var(--surface);border-radius:8px;border:1px solid var(--border);padding:24px;position:sticky;top:20px;box-shadow:0 4px 12px rgba(0,0,0,.03)}
    .price-section{margin-bottom:24px;padding-bottom:20px;border-bottom:1px solid var(--border)}
    .price-label{font-size:12px;color:var(--text-secondary);margin-bottom:4px}
    .price-row{display:flex;align-items:baseline;gap:12px}
    .current-price{font-size:36px;font-weight:800;line-height:1}
    .old-price{text-decoration:line-through;color:var(--text-muted);font-size:14px}
    .discount-tag{background:var(--danger-bg);color:var(--danger);font-weight:800;font-size:12px;padding:4px 8px;border-radius:4px;margin-left:auto}
    .stock-info{display:flex;justify-content:space-between;margin-bottom:8px;font-size:13px}
    .stock-label{color:var(--text-secondary)}
    .stock-val{font-weight:800}
    .in-stock{color:var(--success)}
    .qty-control{margin:20px 0;border:1px solid var(--border);border-radius:6px;display:flex;height:44px;overflow:hidden}
    .qty-btn{width:44px;border:none;background:var(--background);font-size:18px;cursor:pointer;transition:.2s}
    .qty-btn:hover{background:#e2e8f0}
    .qty-input{flex:1;border:none;border-left:1px solid var(--border);border-right:1px solid var(--border);text-align:center;font-size:16px;font-weight:700;outline:none}
    .btn-cart{width:100%;background:var(--primary);color:#fff;border:none;padding:14px;border-radius:6px;font-size:15px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:12px;transition:.2s;box-shadow:0 2px 4px rgba(37,99,235,.2)}
    .btn-cart:hover{background:var(--primary-hover)}
    .secondary-actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:auto}
    .btn-outline{background:#fff;border:1px solid var(--border);padding:10px;border-radius:6px;font-size:13px;font-weight:700;color:var(--text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px;transition:.2s}
    .btn-outline:hover{border-color:var(--primary);color:var(--primary);background:#eff6ff}

    /* Details section */
    .full-width-section{background:var(--surface);border-radius:8px;border:1px solid var(--border);margin-top:24px;overflow:hidden}
    .tabs-header{display:flex;border-bottom:1px solid var(--border);background:var(--background)}
    .tab-btn{padding:16px 32px;font-size:14px;font-weight:700;color:var(--text-secondary);cursor:pointer;border-right:1px solid var(--border);background:transparent;transition:.2s;border-bottom:2px solid transparent;user-select:none}
    .tab-btn:hover{background:#e2e8f0;color:var(--text-main)}
    .tab-btn.active{background:var(--surface);color:var(--primary);border-bottom:2px solid var(--primary);border-right:1px solid var(--border)}
    .tab-content-area{padding:32px;min-height:200px}
    .tab-pane{display:none;max-width:900px}
    .tab-pane.active{display:block}
    .tab-pane h3{font-size:18px;margin-bottom:16px}
    .tab-pane p{margin-bottom:16px;color:var(--text-secondary)}
    .tab-pane ul{padding-left:20px;color:var(--text-secondary)}
    .tab-pane li{margin-bottom:10px}

    /* Copy tooltip */
    .copy-tooltip{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(100px);background:#0f172a;color:#fff;padding:10px 20px;border-radius:50px;font-size:14px;font-weight:600;opacity:0;transition:all .4s cubic-bezier(.175,.885,.32,1.275);z-index:999;display:flex;align-items:center;gap:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);pointer-events:none}
    .copy-tooltip.show{opacity:1;transform:translateX(-50%) translateY(0)}

    /* Responsive */
    @media (max-width:1200px){
      .product-grid{grid-template-columns:1fr 340px}
      .gallery-card{grid-column:span 2;gap:24px;height:auto}
      .main-image-container{width:300px;margin-bottom:0}
      .thumbnails{display:flex;flex-direction:column;width:80px;margin-top:0}
    }
    @media (max-width:900px){
      .product-grid{grid-template-columns:1fr}
      .gallery-card{display:block;height:auto}
      .main-image-container{width:100%;margin-bottom:16px}
      .thumbnails{display:grid;width:100%;grid-template-columns:repeat(4,1fr)}
      .header-meta{flex-direction:column;align-items:flex-start}
      .status-badges{margin-left:0;margin-top:8px}
      .buy-box{position:static;height:auto}
    }
  </style>

  <!-- Optional JSON-LD breadcrumb -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Items","item":"https://www.888lots.com/items"},
      {"@type":"ListItem","position":2,"name":"Computers, Laptops & Hardware","item":"https://www.888lots.com/category/computers-laptops-hardware"},
      {"@type":"ListItem","position":3,"name":"Computer Peripheral","item":"https://www.888lots.com/category/computer-peripheral"}
    ]
  }
  </script>
</head>
<body>
  <div class="container">

    <!-- Breadcrumbs (semantic) -->
    <nav class="breadcrumbs" aria-label="Breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
      <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="/items"><span itemprop="name">Items</span></a>
        <meta itemprop="position" content="1"/>
      </span>
      <i class="ph ph-caret-right" aria-hidden="true"></i>
      <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="/category/computers-laptops-hardware"><span itemprop="name">Computers, Laptops &amp; Hardware</span></a>
        <meta itemprop="position" content="2"/>
      </span>
      <i class="ph ph-caret-right" aria-hidden="true"></i>
      <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="/category/computer-peripheral"><span itemprop="name">Computer Peripheral</span></a>
        <meta itemprop="position" content="3"/>
      </span>
    </nav>

    <!-- Pills duplicated from categories + brand + parameters -->
    <div class="hashtag-row" id="hashtagRow" role="navigation" aria-label="Quick links"></div>

    <!-- Header -->
    <header class="product-header">
      <h1 class="product-title">
        Razer Viper Ultimate Lightweight Wireless Gaming Mouse: Fastest Gaming Switches - 20K DPI Optical Sensor - Chroma Lighting - 8 Programmable Buttons - 70 Hr Battery - Classic Black
      </h1>

      <div class="header-meta">
        <div class="hashtags">
          <a href="#" class="tag">#Razer</a>
          <a href="#" class="tag">#GamingMouse</a>
          <a href="#" class="tag">#Wireless</a>
        </div>

        <div class="id-chips">
          <div class="id-chip" onclick="copyToClipboard('888 B08565C5BB US','SKU')"><span style="opacity:.6">SKU:</span> 888 B08565C5BB US <i class="ph ph-copy"></i></div>
          <div class="id-chip" onclick="copyToClipboard('B08565C5BB','ASIN')"><span style="opacity:.6">ASIN:</span> B08565C5BB <i class="ph ph-copy"></i></div>
          <div class="id-chip" onclick="copyToClipboard('0810091280019','UPC')"><span style="opacity:.6">UPC:</span> 0810091280019 <i class="ph ph-copy"></i></div>
        </div>

        <div class="status-badges">
          <span class="badge fba">FBA</span>
          <span class="badge promo">First Order</span>
        </div>
      </div>
    </header>

    <!-- Main Grid -->
    <div class="product-grid">

      <!-- Column 1: Gallery -->
      <div class="gallery-card">
        <div class="main-image-container">
          <img id="mainImg" class="main-image" alt="Razer Viper Ultimate" src="https://m.media-amazon.com/images/I/6157EeRHinL._UL_1000_.jpg">
        </div>
        <div class="thumbnails">
          <div class="thumb active" onclick="swapImg(this,'https://m.media-amazon.com/images/I/6157EeRHinL._UL_1000_.jpg')">
            <img src="https://m.media-amazon.com/images/I/6157EeRHinL._UL_300_SS300_.jpg" alt="Main View">
          </div>
          <div class="thumb" onclick="swapImg(this,'https://m.media-amazon.com/images/I/71VU5sVbjML.jpg')">
            <img src="https://m.media-amazon.com/images/I/71VU5sVbjML._UL_300_SS300_.jpg" alt="Top View">
          </div>
          <div class="thumb" onclick="swapImg(this,'https://m.media-amazon.com/images/I/8116loSN2PL.jpg')">
            <img src="https://m.media-amazon.com/images/I/8116loSN2PL._UL_300_SS300_.jpg" alt="Side View">
          </div>
          <div class="thumb" onclick="swapImg(this,'https://m.media-amazon.com/images/I/615-YKhzOZL.jpg')">
            <img src="https://m.media-amazon.com/images/I/615-YKhzOZL._UL_300_SS300_.jpg" alt="Perspective">
          </div>
        </div>
      </div>

      <!-- Column 2: Data -->
      <div class="data-column">
        <div class="data-stack">
          <div class="info-card">
            <div class="info-header" style="background:#f0fdf4;color:#15803d;border-color:#bbf7d0">
              <i class="ph-fill ph-money"></i> Profit Estimation
            </div>
            <div class="profit-section">
              <div class="profit-row"><span>Est. Sell Price (Az)</span><strong id="estAzPrice">$129.00</strong></div>
              <div class="profit-row"><span>Your Cost</span><strong id="yourCost" style="color:var(--danger)">- $89.00</strong></div>
              <div class="profit-row final">
                <span>Net Profit</span>
                <div style="display:flex;align-items:center">
                  <span class="profit-value-large" id="netProfit">+$40.00</span><span class="roi-pill" id="roiPill">45% ROI</span>
                </div>
              </div>
            </div>
          </div>

          <div class="info-card">
            <div class="info-header">Market Intelligence</div>

            <!-- Grid now includes AZ DATA -->
            <div class="market-grid">
              <div class="data-point">
                <span class="data-label">Est. Az Price</span>
                <span class="data-value" id="miAzPrice">$129.00</span>
              </div>

              <div class="data-point">
                <span class="data-label">MSRP</span>
                <span class="data-value" style="color:var(--text-muted);text-decoration:line-through">$129.99</span>
              </div>

              <div class="data-point">
                <span class="data-label">Est. Az Buy Box</span>
                <span class="data-value data-muted" id="miBuyBox">Data not available</span>
              </div>

              <div class="data-point">
                <span class="data-label">Az Sales Rank</span>
                <span class="data-value" id="miRank">#112</span>
              </div>

              <div class="data-point">
                <span class="data-label">Az Offers</span>
                <span class="data-value" id="miOffers">4</span>
              </div>

              <div class="data-point">
                <span class="data-label">ASIN</span>
                <span class="data-value" id="miAsin">B08565C5BB</span>
              </div>
            </div>

            <p class="micro-note">
              *Estimated Buy Box price may vary. Amazon pricing and offers change frequently; we update as often as possible.
            </p>

            <div class="tools-bar">
              <a href="#" class="tool-btn"><i class="ph ph-chart-line-up"></i>Keepa</a>
              <a href="#" class="tool-btn"><i class="ph ph-calculator"></i>Calculator</a>
              <a href="#" class="tool-btn"><i class="ph-fill ph-amazon-logo"></i>Amazon</a>
              <a href="#" class="tool-btn"><i class="ph-fill ph-google-logo"></i>Google</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Column 3: Buy Box -->
      <aside class="buy-box">
        <div class="price-section">
          <div class="price-label">Wholesale Price</div>
          <div class="price-row">
            <span class="current-price">$89.00</span>
            <span class="old-price">$95.00</span>
            <span class="discount-tag">-6%</span>
          </div>
        </div>
        <div class="stock-info"><span class="stock-label">In Stock</span><span class="stock-val in-stock">132 units</span></div>
        <div class="stock-info"><span class="stock-label">MOQ</span><span class="stock-val">100 units</span></div>
        <div class="qty-control">
          <button class="qty-btn" onclick="updateQty(-1)">−</button>
          <input id="qtyInput" class="qty-input" type="number" value="100" min="100" max="132">
          <button class="qty-btn" onclick="updateQty(1)">+</button>
        </div>
        <button class="btn-cart"><i class="ph-bold ph-shopping-cart-simple"></i>Add to Cart</button>
        <div class="secondary-actions">
          <button class="btn-outline"><i class="ph-bold ph-handshake"></i>Negotiate</button>
          <button class="btn-outline"><i class="ph-bold ph-heart"></i>Watch</button>
        </div>
      </aside>
    </div>

    <!-- Details -->
    <div class="full-width-section">
      <div class="tabs-header">
        <div class="tab-btn active" onclick="switchTab(event,'desc')">Description</div>
        <div class="tab-btn" onclick="switchTab(event,'specs')">Specifications</div>
        <div class="tab-btn" onclick="switchTab(event,'shipping')">Shipping Info</div>
      </div>
      <div class="tab-content-area">
        <div id="desc" class="tab-pane active">
          <h3>Product Overview</h3>
          <p><strong>Razer Viper Ultimate Lightweight Wireless Gaming Mouse:</strong> Fastest Gaming Switches - 20K DPI Optical Sensor - Chroma Lighting - 8 Programmable Buttons - 70 Hr Battery - Classic Black</p>
          <ul>
            <li><strong>25% Quicker</strong> than many wireless mice via HyperSpeed wireless.</li>
            <li><strong>74g lightweight</strong> with 20K DPI optical sensor.</li>
            <li><strong>Optical switches</strong> register at the speed of light.</li>
            <li><strong>Ambidextrous</strong> with side buttons on both sides.</li>
          </ul>
        </div>
        <div id="specs" class="tab-pane">
          <h3>Technical Specifications</h3>
          <ul>
            <li><strong>Brand:</strong> Razer</li>
            <li><strong>Model:</strong> Viper Ultimate</li>
            <li><strong>Color:</strong> Classic Black</li>
            <li><strong>DPI:</strong> 20,000 Optical Sensor</li>
            <li><strong>Buttons:</strong> 8 Programmable</li>
            <li><strong>Battery Life:</strong> Up to 70 Hours</li>
            <li><strong>Weight:</strong> 74g</li>
          </ul>
        </div>
        <div id="shipping" class="tab-pane">
          <h3>Shipping & Handling</h3>
          <ul>
            <li><strong>Shipping Cost:</strong> $1 per unit</li>
            <li><strong>Fulfillment:</strong> FBA</li>
            <li><strong>Processing:</strong> 1–2 business days</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Copy tooltip -->
  <div id="copyTooltip" class="copy-tooltip">
    <i class="ph-fill ph-check-circle" style="color:#4ade80"></i>
    <span id="tooltipText">Copied to clipboard</span>
  </div>

  <script>
    /* ---------- DATA FOR PILLS + AZ DATA (swap with backend feed) ---------- */
    const productData = {
      brand: "Razer",
      categories: [
        { name: "Items", slug: "items" },
        { name: "Computers, Laptops & Hardware", slug: "computers-laptops-hardware" },
        { name: "Computer Peripheral", slug: "computer-peripheral" }
      ],
      tags: ["GamingMouse", "Wireless"],
      flags: {
        fba: true, first_order: true, negotiate: true, pickup_and_save: true,
        trending: false, price_drop: true, staff_picks: true, restock: false,
        suggested: true, store_1: true, store_5: true, store_c8: true,
        brand_new: true, refurbished: false, fba_fulfilled: true
      },
      delivered_at: "2025-03-02T00:00:00Z",
      azData: {
        asin: "B08565C5BB",
        est_buy_box: null,         // null => show "Data not available"
        sales_rank: 112,
        offers: 4,
        est_price: 129.00
      }
    };

    /* ---------- PILLS RENDER ---------- */
    const slugify = s => String(s||'').toLowerCase().replace(/&/g,'-and-').replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
    const addPill = (row,{label,href,icon='ph-hash',muted=false})=>{
      const a=document.createElement('a');
      a.className='hashtag'+(muted?' hashtag-muted':'');
      a.href=href; a.innerHTML=`<i class="ph ${icon}"></i>${label}`;
      row.appendChild(a);
    };
    function renderHashtagPills(product){
      const row=document.getElementById('hashtagRow'); if(!row) return;
      row.innerHTML='';

      (product.categories||[]).forEach(cat=>{
        const name=cat.name||cat, slug=cat.slug||slugify(name);
        addPill(row,{label:name,href:`/category/${slug}`});
      });

      if(product.brand){
        addPill(row,{label:product.brand,href:`/brand/${slugify(product.brand)}`,icon:'ph-certificate'});
      }

      (product.tags||[]).forEach(t=>{
        addPill(row,{label:t,href:`/keyword/${slugify(t)}`});
      });

      const f=product.flags||{};
      const map=[
        ['FBA','fba','/program/fba','ph-truck'],
        ['First Order','first_order','/program/first-order','ph-sparkle'],
        ['Negotiate','negotiate','/program/negotiate','ph-handshake'],
        ['Pickup & Save','pickup_and_save','/program/pickup-and-save','ph-storefront'],
        ['Trending','trending','/program/trending','ph-trend-up'],
        ['Price Drop','price_drop','/program/price-drop','ph-arrow-circle-down'],
        ['Staff Picks','staff_picks','/program/staff-picks','ph-seal-check'],
        ['Restock','restock','/program/restock','ph-clock-counter-clockwise'],
        ['Suggested','suggested','/program/suggested','ph-target'],
        ['$1 Store','store_1','/program/1-dollar-store','ph-shopping-bag'],
        ['$5 Store','store_5','/program/5-dollar-store','ph-shopping-bag'],
        ['c8 Store','store_c8','/program/c8-store','ph-shopping-bag']
      ];
      map.forEach(([label,key,url,icon])=>{ if(f[key]) addPill(row,{label,href:url,icon}); });

      const condMap=[
        ['Brand New','brand_new','/condition/brand-new','ph-star'],
        ['Refurbished','refurbished','/condition/refurbished','ph-toolbox'],
        ['Fulfilled by Amazon','fba_fulfilled','/condition/fba','ph-amazon-logo']
      ];
      condMap.forEach(([label,key,url,icon])=>{ if(f[key]) addPill(row,{label,href:url,icon}); });

      const dateStr = product.delivered_at || product.created_at || product.updated_at;
      if(dateStr){
        const days = Math.floor((Date.now() - new Date(dateStr).getTime()) / (1000*60*60*24));
        if(days <= 21){ addPill(row,{label:'Newest',href:'/program/newest',icon:'ph-sparkle'}); }
      }
    }
    renderHashtagPills(productData);

    /* ---------- INJECT AZ DATA INTO MIDDLE SECTION ---------- */
    (function syncAzData(p){
      const az = p.azData||{};
      document.getElementById('miAsin').textContent = az.asin || '—';
      document.getElementById('miOffers').textContent = (az.offers ?? '—');
      document.getElementById('miRank').textContent   = (az.sales_rank ? `#${az.sales_rank}` : '—');
      document.getElementById('miBuyBox').textContent = (az.est_buy_box!=null ? `$${az.est_buy_box.toFixed(2)}` : 'Data not available');
      if(az.est_price!=null){
        document.getElementById('miAzPrice').textContent = `$${az.est_price.toFixed(2)}`;
        document.getElementById('estAzPrice').textContent = `$${az.est_price.toFixed(2)}`;
      }
    })(productData);

    /* ---------- UI Handlers ---------- */
    function swapImg(el,src){
      document.getElementById('mainImg').src=src;
      document.querySelectorAll('.thumb').forEach(t=>t.classList.remove('active'));
      el.classList.add('active');
    }
    function updateQty(delta){
      const input=document.getElementById('qtyInput');
      let val=parseInt(input.value||'0',10)+delta;
      const min=parseInt(input.min,10), max=parseInt(input.max,10);
      if(val>=min && val<=max) input.value=val;
    }
    function switchTab(evt,tabId){
      document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
      document.querySelectorAll('.tab-pane').forEach(p=>p.classList.remove('active'));
      evt.currentTarget.classList.add('active');
      document.getElementById(tabId).classList.add('active');
    }
    function copyToClipboard(text,label){
      navigator.clipboard.writeText(text).then(()=>{
        const tip=document.getElementById('copyTooltip');
        document.getElementById('tooltipText').innerText=`${label} Copied!`;
        tip.classList.add('show'); setTimeout(()=>tip.classList.remove('show'),2000);
      });
    }
  </script>
</body>
</html>
